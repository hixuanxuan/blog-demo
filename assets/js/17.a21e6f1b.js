(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{297:function(t,a,s){"use strict";s.r(a);var n=s(16),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"hybrid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hybrid"}},[t._v("#")]),t._v(" Hybrid")]),t._v(" "),s("h3",{attrs:{id:"_1-file协议与http协议区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-file协议与http协议区别"}},[t._v("#")]),t._v(" 1. file协议与http协议区别")]),t._v(" "),s("ul",[s("li",[t._v("file协议\n"),s("ul",[s("li",[t._v("其实在一开始接触开发，就已经使用了file协议")]),t._v(" "),s("li")])])]),t._v(" "),s("h4",{attrs:{id:"_1-1-格式不同"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-格式不同"}},[t._v("#")]),t._v(" 1.1 格式不同")]),t._v(" "),s("p",[t._v("file协议 file:// /file path")]),t._v(" "),s("h4",{attrs:{id:"_1-2-加载速度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-加载速度"}},[t._v("#")]),t._v(" 1.2 加载速度")]),t._v(" "),s("p",[t._v("file协议非常快，http协议需要网络请求，比较慢")]),t._v(" "),s("p",[t._v("file协议用于访问本地计算机的文件，它是针对本地的，它只是简单的请求了本地文件，将其作为一个服务器未解析的静态文件打开，不可进行跨域操作。file协议有一个类似http的远程访问，即ftp协议（文本传输协议）。")]),t._v(" "),s("p",[t._v("http访问本地html文件，相当于将本机作为一台http服务器，通过localhost访问本地的服务器，然后通过http服务器去访问本机文件资源。本地搭建http服务器开放端口后，别人可通过http访问到你电脑中的文件")]),t._v(" "),s("h3",{attrs:{id:"_2-hybird常用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-hybird常用"}},[t._v("#")]),t._v(" 2.Hybird常用")]),t._v(" "),s("h4",{attrs:{id:"_2-1-hybird是什么，为何用hybird"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-hybird是什么，为何用hybird"}},[t._v("#")]),t._v(" 2.1 Hybird是什么，为何用hybird")]),t._v(" "),s("p",[t._v("不是所有场景都适合Hybird：")]),t._v(" "),s("ul",[s("li",[t._v("使用Native ： 体验要求极致，变化不频繁，如头条的首页")]),t._v(" "),s("li",[t._v("使用Hybird ： 体验要求高，变化频繁，如头条的新闻详情页面")]),t._v(" "),s("li",[t._v("使用h5 : 体验无要求，不是很常用，如举报、反馈、等页面")])]),t._v(" "),s("p",[t._v("实现：")]),t._v(" "),s("ul",[s("li",[t._v("前端做好静态页面（html,js ,css），将文件转交给客户端，")]),t._v(" "),s("li",[t._v("客户端拿到静态页面，以文件形式存储到app中")]),t._v(" "),s("li",[t._v("客户端在一个webview中")]),t._v(" "),s("li",[t._v("使用file协议加载静态页面")])]),t._v(" "),s("p",[t._v("遗留问题")]),t._v(" "),s("ul",[s("li",[t._v("app发布之后，静态文件如何更新")]),t._v(" "),s("li",[t._v("静态文件如何获取内容")])]),t._v(" "),s("h4",{attrs:{id:"_2-2-介绍一下hybird更新和上线的流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-介绍一下hybird更新和上线的流程"}},[t._v("#")]),t._v(" 2.2 介绍一下hybird更新和上线的流程")]),t._v(" "),s("p",[t._v("思考（目的，可行途径）")]),t._v(" "),s("ul",[s("li",[t._v("要替换每个客户端的静态文件")]),t._v(" "),s("li",[t._v("只能客户端来做")]),t._v(" "),s("li",[t._v("客户端去server下载最新的静态文件")]),t._v(" "),s("li",[t._v("我们来维护server的文件")])]),t._v(" "),s("p",[t._v("完整流程\nzip包 （时间戳版本管理）（html,css,js）=》客户端解压=》")]),t._v(" "),s("ul",[s("li",[t._v("分版本 有版本号")]),t._v(" "),s("li",[t._v("将静态文件压缩成zip包，上传到服务端")]),t._v(" "),s("li",[t._v("客户端每次启动，都去服务端检查版本号。")]),t._v(" "),s("li",[t._v("如果服务端版本号，就去下载最新的zip包")]),t._v(" "),s("li",[t._v("下载完成后解压包，将现有文件覆盖")])]),t._v(" "),s("h4",{attrs:{id:"_2-3-hybird和h5的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-hybird和h5的区别"}},[t._v("#")]),t._v(" 2.3 Hybird和h5的区别")]),t._v(" "),s("ol",[s("li",[t._v("优点\n体验更好，和Native基本一致")]),t._v(" "),s("li",[t._v("缺点")])]),t._v(" "),s("ul",[s("li",[t._v("开发成本高。联调、测试、查bug都比较麻烦。")]),t._v(" "),s("li",[t._v("运维成本高")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("适用的场景")])]),t._v(" "),s("ul",[s("li",[t._v("hybird：产品的稳定的功能，体验要求高，迭代频繁")]),t._v(" "),s("li",[t._v("h5:单次的运营活动（如XXX红包）或者不常用功能")])]),t._v(" "),s("h3",{attrs:{id:"_3-js和客户端通讯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-js和客户端通讯"}},[t._v("#")]),t._v(" 3. JS和客户端通讯")]),t._v(" "),s("h4",{attrs:{id:"_3-1-基本形式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-基本形式"}},[t._v("#")]),t._v(" 3.1. 基本形式")]),t._v(" "),s("ul",[s("li",[t._v("封装方法，比如invoke.js，内置到客户端")]),t._v(" "),s("li",[t._v("客户端每次启动webview，都默认执行invoke.js ，将方法挂载到了window上面")]),t._v(" "),s("li",[t._v("本地加载，免去网络加载的时间，更快。")]),t._v(" "),s("li",[t._v("本地加载没有网络请求，黑客看不到schema协议，更安全")])]),t._v(" "),s("h4",{attrs:{id:"_3-2-schema协议的简介和使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-schema协议的简介和使用"}},[t._v("#")]),t._v(" 3.2. schema协议的简介和使用")]),t._v(" "),s("ul",[s("li",[t._v("通讯的基本形式，（下面附上代码）调用能力，传递参数，监听回调")]),t._v(" "),s("li",[t._v("对schema协议的理解和使用")]),t._v(" "),s("li",[t._v("调用schema代码的封装")]),t._v(" "),s("li",[t._v("内置上线的好处，更快，更安全")])]),t._v(" "),s("h4",{attrs:{id:"_3-3-schema使用的封装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-schema使用的封装"}},[t._v("#")]),t._v(" 3.3. schema使用的封装")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_invoke")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("callback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拼接schema协议")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mayapp://utils'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'?a=a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hasOwnProperty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'='")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("   \n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 处理callback")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" callbackName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" callback"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            callbackName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            callbackName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("action"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("callbackName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("callback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        schema"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&callback='")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("callbackName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" iframe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'iframe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        iframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("display"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        iframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("schema"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//发出一个请求被app拦截")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" body"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iframe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            iframe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);